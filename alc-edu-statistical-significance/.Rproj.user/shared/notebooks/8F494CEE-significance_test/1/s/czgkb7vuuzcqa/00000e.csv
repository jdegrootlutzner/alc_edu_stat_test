"0","# Abstainer (A)"
"0","a_prob_before = 0.36"
"0","a_prob_after = 0.34"
"0","nat_change_a = -0.06"
"0","pz_change_a = -0.13"
"0","# Nondrinker (N)"
"0","n_prob_before = 0.28"
"0","n_prob_after = 0.22"
"0","nat_change_n = -0.21"
"0","pz_change_n = -0.46"
"0","# Moderate drinker (M)"
"0","m_prob_before = 0.19"
"0","m_prob_after = 0.21"
"0","nat_change_m = 0.11"
"0","pz_change_m = 0.08"
"0","# Heavy Episodic Drinker (H)"
"0","h_prob_before = 0.13"
"0","h_prob_after = 0.17"
"0","nat_change_h = 0.31"
"0","pz_change_h = 0.43"
"0","# Problemactic Drinker (P)"
"0","p_prob_before = 0.05"
"0","p_prob_after = 0.07"
"0","nat_change_p = 0.40"
"0","pz_change_p = 2.50"
"0","drinking_types = c(""A"",""N"",""M"",""H"",""P"")"
"0","probs_before = c(a_prob_before, n_prob_before, m_prob_before,"
"0","                 h_prob_before, p_prob_before)"
"0","probs_after = c(a_prob_after, n_prob_after, m_prob_after,"
"0","                h_prob_after, p_prob_after)"
"0","# I used the number of respondents to survey 3"
"0","pz_sample_size = 173"
"0","results <- data.frame()"
"0","p_values <- c(0,0,0,0,0)"
"0","num_simulations = 10"
"0","set.seed(4747)"
"0","for(s in 1:num_simulations){"
"0","    # random sample of drinking types with prob from national averages"
"0","    rd_samp_before <- sample(drinking_types,"
"0","                             pz_sample_size,"
"0","                             replace = TRUE,"
"0","                             prob = probs_before)"
"0","    "
"0","    # random sample of drinking after with prob from national averages"
"0","    rd_samp_after <- sample(drinking_types, "
"0","                            pz_sample_size, "
"0","                            replace = TRUE,"
"0","                            prob = probs_after)"
"0","    "
"0","    # The chart measures the percent change in the number of drinking types before"
"0","    # survey 3 to the same number after survey 3."
"0","    # Mathematically, this is (after/before - 1)"
"0","    a_change = sum(rd_samp_after == ""A"")/sum(rd_samp_before == ""A"") - 1"
"0","    n_change = sum(rd_samp_after == ""N"")/sum(rd_samp_before == ""N"") - 1"
"0","    m_change = sum(rd_samp_after == ""M"")/sum(rd_samp_before == ""M"") - 1"
"0","    h_change = sum(rd_samp_after == ""H"")/sum(rd_samp_before == ""H"") - 1"
"0","    p_change = sum(rd_samp_after == ""P"")/sum(rd_samp_before == ""P"") - 1"
"0","   "
"0","    # keep track of changes each simulation"
"0","    results <- rbind(results, c(a_change, n_change, m_change, h_change, p_change))"
"0","    # keep track of the number of times simulated change is bigger/smaller  "
"0","    # (respectively) then the PZ test changes"
"0","    p_values <- p_values + c(a_change > pz_change_a,"
"0","                                 n_change > pz_change_n,"
"0","                                 m_change > pz_change_m,"
"0","                                 h_change < pz_change_h,"
"0","                                 p_change < pz_change_p)"
"0","    "
"0","}"
"0","names(results) <- c(""Change.Abstainers"",""Change.Nondrinkers"","
"0","                    ""Change.Moderate.Drinkers"",""Change.Heavy.Episodic.Drinkers"","
"0","                    ""Change.Problemactic.Drinkers"")"
"0","p_values <- data.frame(p_values/num_simulations)"
"0","p_values <- cbind( p_values, Type.Drinker = c(""Abstainers"", ""Nondrinkers"","
"0","                    ""Moderate.Drinkers"", ""Heavy.Episodic.Drinkers"","
"0","                     ""Problemactic.Drinkers"" ))"
