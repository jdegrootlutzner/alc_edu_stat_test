{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Alcohol EDU Statistical Significance\"\nauthor: \"Julian DeGroot-Lutzner\"\ndate: \"12/7/2017\"\noutput: pdf_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE, message=FALSE,\nwarning=FALSE, cache=TRUE)\n```\n```{r}\nrequire(ggplot2)\n```\n\n```{r}\n# Abstainer (A)\na_prob_before = 0.36\na_prob_after = 0.34\nnat_change_a = -0.06\npz_change_a = -0.13\n\n# Nondrinker (N)\nn_prob_before = 0.28\nn_prob_after = 0.22\nnat_change_n = -0.21\npz_change_n = -0.46\n\n# Moderate drinker (M)\nm_prob_before = 0.19\nm_prob_after = 0.21\nnat_change_m = 0.11\npz_change_m = 0.08\n\n# Heavy Episodic Drinker (H)\nh_prob_before = 0.13\nh_prob_after = 0.17\nnat_change_h = 0.31\npz_change_h = 0.43\n\n# Problemactic Drinker (P)\np_prob_before = 0.05\np_prob_after = 0.07\nnat_change_p = 0.40\npz_change_p = 2.50\n\ndrinking_types = c(\"A\",\"N\",\"M\",\"H\",\"P\")\nprobs_before = c(a_prob_before, n_prob_before, m_prob_before,\n                 h_prob_before, p_prob_before)\nprobs_after = c(a_prob_after, n_prob_after, m_prob_after,\n                h_prob_after, p_prob_after)\n\npz_sample_size_before = 175\npz_sample_size_after = 173\n\n\n\n\nresults <- data.frame()\np_values <- c(0,0,0,0,0)\nnum_simulations = 50000\nset.seed(4747)\nfor(s in 1:num_simulations){\n    # random sample of drinking types with prob from national averages\n    rd_samp_before <- sample(drinking_types,\n                             pz_sample_size_before,\n                             replace = TRUE,\n                             prob = probs_before)\n    \n    # random sample of drinking after with prob from national averages\n    rd_samp_after <- sample(drinking_types, \n                            pz_sample_size_after, \n                            replace = TRUE,\n                            prob = probs_after)\n    \n    # The chart measures the percent change in the number of drinking types before\n    # survey 3 to the same number after survey 3.\n    # Mathematically, this is (after/before - 1)\n    a_change = sum(rd_samp_after == \"A\")/sum(rd_samp_before == \"A\") - 1\n    n_change = sum(rd_samp_after == \"N\")/sum(rd_samp_before == \"N\") - 1\n    m_change = sum(rd_samp_after == \"M\")/sum(rd_samp_before == \"M\") - 1\n    h_change = sum(rd_samp_after == \"H\")/sum(rd_samp_before == \"H\") - 1\n    p_change = sum(rd_samp_after == \"P\")/sum(rd_samp_before == \"P\") - 1\n   \n    # keep track of changes each simulation\n    results <- rbind(results, c(a_change, n_change, m_change, h_change, p_change))\n\n    # keep track of the number of times simulated change is bigger/smaller  \n    # (respectively) then the PZ test changes\n    p_values <- p_values + c(a_change <= pz_change_a,\n                                 n_change <= pz_change_n,\n                                 m_change <= pz_change_m,\n                                 h_change >= pz_change_h,\n                                 p_change >= pz_change_p)\n    \n}\nnames(results) <- c(\"Change.Abstainers\",\"Change.Nondrinkers\",\n                    \"Change.Moderate.Drinkers\",\"Change.Heavy.Episodic.Drinkers\",\n                    \"Change.Problemactic.Drinkers\")\np_values <- data.frame(p_values/num_simulations)\np_values <- cbind( p_values, Type.Drinker = c(\"Abstainers\", \"Nondrinkers\",\n                    \"Moderate.Drinkers\", \"Heavy.Episodic.Drinkers\",\n                     \"Problemactic.Drinkers\" ))\np_values\n```\n\n```{r}\nggplot(results, aes(x = Change.Abstainers)) + \n  geom_histogram(binwidth=.1, colour=\"black\", fill=\"white\") + \n  ggtitle(\"Distribution of Abstainer 'Change' Value\",\n          subtitle = \"P Value = 0.31588 \") +\n  geom_vline(xintercept = pz_change_a)\n\nggplot(results, aes(x = Change.Nondrinkers)) + \n  geom_histogram(binwidth=.1, colour=\"black\", fill=\"white\") + \n  ggtitle(\"Distribution of Nondrinkers 'Change' Value\",\n          subtitle = \"P Value = 0.03340*\") +\n  geom_vline(xintercept = pz_change_n)\n\nggplot(results, aes(x = Change.Moderate.Drinkers)) + \n  geom_histogram(binwidth=.1, colour=\"black\", fill=\"white\") + \n  ggtitle(\"Distribution of Moderate Drinkers 'Change' Value\",\n          subtitle = \"P Value = 0.47274\") +\n  geom_vline(xintercept = pz_change_m)\n\nggplot(results, aes(x = Change.Heavy.Episodic.Drinkers)) + \n  geom_histogram(binwidth=.1, colour=\"black\", fill=\"white\") + \n  ggtitle(\"Distribution of Heavy Episodic Drinkers 'Change' Value\",\n          subtitle = \"P Value = 0.35036\") +\n  geom_vline(xintercept =pz_change_h)\n\nggplot(results, aes(x = Change.Problemactic.Drinkers)) + \n  geom_histogram(binwidth=.1, colour=\"black\", fill=\"white\") + \n  ggtitle(\"Distribution of Problemactic Drinkers 'Change' Value\",\n          subtitle = \"P Value = 0.03464*\") +\n  geom_vline(xintercept =pz_change_p)\n```\n",
    "created" : 1512719252424.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "717604892",
    "id" : "1E93217F",
    "lastKnownWriteTime" : 1512762525,
    "last_content_update" : 1512762525452,
    "path" : "~/Documents/Junior Year - 1st Semester/alc-edu-statistical-significance/significance_test.Rmd",
    "project_path" : "significance_test.Rmd",
    "properties" : {
        "last_setup_crc32" : "D5DD1EDFbb338d19",
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}